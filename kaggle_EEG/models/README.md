# model selection results in our final submission
In our implementation, model selection is done for every single event. And for each event, the best combination list are as follows:
1. event 1
 1. len3584_resize3_c1r4p5_f9n256r35p1
 2. len4608_bs_c1r4p5_f9n128r35p2
 3. len2048p4_resize3_bs_c1r4p5_f9n256r35p1
 4. len3584_resize3_bs_c1r4p5_f9n256r35p1
 5. len2048p1_resize3_bs_c1r4p5_f9n256r35p1
 6. len4608_leaky_bs_c1r4p5_f9n128r35p2
 7. len4096_resize3_bs_c1r4p5_f9n256r35p1
 8. len2560p4_resize3_bs_c1r4p5_f9n256r35p1
 9. len4096_downsample4_bs_c1r4p5_f9n128r35p2
 10. fake_shuffle_op_len4096_downsample2_bs_c1r4p5_f9n160r35p2
 11. fake_shuffle_len2048p4_bs_c1r4p5_f9n256r35p1
 12. fake_shuffle_len4096_downsample2_bs_c1r4p5_f9n160r35p2
 13. fake_shuffle_len2048p1_bs_c1r4p5_f9n192r35p2
 14. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
 15. fake_shuffle_len4096_resize2_bs_c1r4p5_f9n128r25p2
 16. len2048p4_resize3_c1r4p5_f9n256r35p1

2. event 2
 1. len3584_resize3_bs_c1r4p5_f9n128r35p1
 2. len4608_bs_c1r4p5_f9n128r35p2
 3. len2560p1_resize3_bs_c1r4p5_f9n256r35p1
 4. len4096_downsample4_resize3_bs_c7p7_f9n128_r35p1
 5. len2048p1_resize3_bs_c1r4p5_f9n256r35p1
 6. len4608_leaky_bs_c1r4p5_f9n128r35p2
 7. len3584_resize3_bs_c1r4p5_f9n256r35p1
 8. len2560p1_resize3_bs_c1r4p5_f9n128r35p1
 9. len4096_downsample8_bs_c1r4p5_f9n128r35p2
 10. fake_shuffle_len2048p4_bs_c1r4p5_f9n256r35p1
 11. fake_shuffle_len4096_resize2_bs_c1r4p5_f9n128r25p2
 12. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
 13. fake_shuffle_len2048p1_bs_c1r4p5_f9n192r35p2
 14. fake_shuffle_len4096_downsample2_bs_c1r4p5_f9n160r35p2
 15. fake_shuffle_len4096_bs_c1r4p5_f9n128r35p2
 16. len2048p4_resize3_bs_c1r4p5_f9n256r35p1
 17. len2048_resize3_bs_c8p8_f9n256_r35p1

3. event 3
 1. resize3_c1r4p5_f9n128r35p1
 2. len4608_bs_c1r4p5_f9n128r35p2
 3. len2560p1_resize3_bs_c1r4p5_f9n256r35p1
 4. len4096_downsample4_bs_c1r4p5_f9n128r35p2
 5. len2560p1_resize3_bs_c1r4p5_f9n128r35p1
 6. len3584_resize3_bs_c1r4p5_f9n128r35p1
 7. len2048p1_resize3_bs_c1r4p5_f9n256r35p1
 8. len4608_leaky_bs_c1r4p5_f9n128r35p2
 9. len4096_downsample4_resize3_bs_c7p7_f9n128_r35p1
 10. fake_shuffle_len2048p4_bs_c1r4p5_f9n256r35p1
 11. fake_shuffle_len4096_resize2_bs_c1r4p5_f9n128r25p2
 12. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
 13. fake_shuffle_len2048p1_bs_c1r4p5_f9n192r35p2
 14. fake_shuffle_c9p9_bs_f9n64_r35p2
 15. len2048p4_resize3_bs_c1r4p5_f9n256r35p1
 16. fake_shuffle_len4096_downsample2_bs_c1r4p5_f9n160r35p2
 17. fake_shuffle_len2048p4_resize3_c1r4p5_f9n128r35p1
 18. fake_shuffle_len4096_bs_c1r4p5_f9n128r35p2
 19. len3584_resize3_bs_c1r4p5_f9n256r35p1
 20. fake_shuffle_op_len4096_downsample2_bs_c1r4p5_f9n160r35p2

4. event 4
 1. resize3_c1r4p5_f9n128r35p1
 2. len2048p1_resize3_bs_c1r4p5_f9n256r35p1
 3. len4608_leaky_bs_c1r4p5_f9n128r35p2
 4. len4096_resize3_bs_c1r4p5_f9n128r35p1
 5. len2048p4_resize3_bs_c1r4p5_f9n256r35p1
 6. len4096_downsample4_bs_c1r4p5_f9n128r35p2
 7. len2560p1_resize3_bs_c1r4p5_f9n256r35p1
 8. len3584_resize3_bs_c1r4p5_f9n256r35p1
 9. len4608_bs_c1r4p5_f9n128r35p2
 10. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
 11. fake_shuffle_len2048p4_bs_c1r4p5_f9n256r35p1
 12. fake_shuffle_len4096_resize2_bs_c1r4p5_f9n128r25p2
 13. len2560p1_resize3_bs_c1r4p5_f9n128r35p1
 14. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
 15. fake_shuffle_len2048p4_resize3_bs_c1r4p5_f9n128r35p1
 16. fake_shuffle_len4096_bs_c1r4p5_f9n128r35p2
 17. fake_shuffle_op_len4096_downsample2_bs_c1r4p5_f9n160r35p2
 18. resize3_bs_c1r4p5_f9n256r35p1
 19. len2048_resize3_bs_c8p8_f9n256_r35p1
 20. fake_shuffle_len3584_bs_c1r4p5_f9n192r35p2
 21. len2048p1_resize3_bs_c1r4p5_f9n128r35p1
 22. len4096_downsample8_leaky_bs_c1r4p5_f9n128r35p2

5. event 5
 1. len3584_resize3_bs_c1r4p5_f9n256r35p1
 2. len4096_downsample4_bs_c1r4p5_f9n128r35p2
 3. len2560p1_resize3_bs_c1r4p5_f9n256r35p1
 4. len4608_leaky_bs_c1r4p5_f9n128r35p2
 5. len4096_resize3_bs_c1r4p5_f9n128r35p1
 6. len2048p4_resize3_bs_c1r4p5_f9n256r35p1
 7. len4608_bs_c1r4p5_f9n128r35p2
 8. len4096_downsample4_leaky_bs_c1r4p5_f9n128r35p2
 9. resize3_bs_c1r4p5_f9n256r35p1
 10. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
 11. fake_shuffle_len4096_downsample2_bs_c1r4p5_f9n160r35p2
 12. fake_shuffle_len2048p4_bs_c1r4p5_f9n256r35p1
 13. fake_shuffle_len4096_bs_c1r4p5_f9n128r35p2
 14. fake_shuffle_len3584_bs_c1r4p5_f9n192r35p2
 15. fake_shuffle_len4096_downsample4_resize3_bs_c1r4p5_f9n128r35p2
 16. len4096_resize3_bs_c1r4p5_f9n256r35p1
 17. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
 18. fake_shuffle_len2048p1_bs_c1r4p5_f9n192r35p2
 19. fake_shuffle_len4608_downsample4_bs_c1r4p5_f9n160r35p2
 20. len2048p1_resize3_bs_c1r4p5_f9n256r35p1
 21. len4096_downsample4_resize3_bs_c7p7_f9n128_r35p1
 22. fake_shuffle_op_len4096_downsample2_bs_c1r4p5_f9n160r35p2

6. event 6
 1. len3584_resize3_bs_c1r4p5_f9n256r35p1
 2. len4096_downsample4_bs_c1r4p5_f9n128r35p2
 3. len2048p1_resize3_bs_c1r4p5_f9n256r35p1
 4. len4096_resize3_bs_c1r4p5_f9n128r35p1
 5. len4608_leaky_bs_c1r4p5_f9n128r35p2
 6. len2048p4_resize3_bs_c1r4p5_f9n256r35p1
 7. len4608_bs_c1r4p5_f9n128r35p2
 8. resize3_bs_c1r4p5_f9n256r35p1
 9. len2560p1_resize3_bs_c1r4p5_f9n128r35p1
 10. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
 11. fake_shuffle_len4096_downsample2_bs_c1r4p5_f9n160r35p2
 12. fake_shuffle_len3584_bs_c1r4p5_f9n192r35p2
 13. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
 14. fake_shuffle_len2048p4_bs_c1r4p5_f9n256r35p1
 15. len4608_c9p9_f9n32_r35p1
 16. fake_shuffle_len4608_downsample4_bs_c1r4p5_f9n160r35p2
 17. len2048p4_resize3_c1r4p5_f9n256r35p1
 18. len4096_resize3_bs_c1r4p5_f9n256r35p1
 19. len2560p4_resize3_bs_c1r4p5_f9n256r35p1
 20. fake_shuffle_len4096_resize2_bs_c1r4p5_f9n128r25p2
 21. len2048p1_resize3_bs_c1r4p5_f9n128r35p1
 22. fake_shuffle_len4096_downsample4_resize3_bs_c1r4p5_f9n128r35p2

Model selection results for the 6 events may have some overlapping. To avoid training the same model repeatedly, the union list are as follows:

1. len3584_resize3_c1r4p5_f9n256r35p1
2. len4608_bs_c1r4p5_f9n128r35p2
3. len2048p4_resize3_bs_c1r4p5_f9n256r35p1
4. len3584_resize3_bs_c1r4p5_f9n256r35p1
5. len2048p1_resize3_bs_c1r4p5_f9n256r35p1
6. len4608_leaky_bs_c1r4p5_f9n128r35p2
7. len4096_resize3_bs_c1r4p5_f9n256r35p1
8. len2560p4_resize3_bs_c1r4p5_f9n256r35p1
9. len4096_downsample4_bs_c1r4p5_f9n128r35p2
10. fake_shuffle_op_len4096_downsample2_bs_c1r4p5_f9n160r35p2
11. fake_shuffle_len2048p4_bs_c1r4p5_f9n256r35p1
12. fake_shuffle_len4096_downsample2_bs_c1r4p5_f9n160r35p2
13. fake_shuffle_len2048p1_bs_c1r4p5_f9n192r35p2
14. fake_shuffle_len3584_downsample2_bs_c1r4p5_f9n192r35p2
15. fake_shuffle_len4096_resize2_bs_c1r4p5_f9n128r25p2
16. len2048p4_resize3_c1r4p5_f9n256r35p1
17. len3584_resize3_bs_c1r4p5_f9n128r35p1
18. len2560p1_resize3_bs_c1r4p5_f9n256r35p1
19. len4096_downsample4_resize3_bs_c7p7_f9n128_r35p1
20. len2560p1_resize3_bs_c1r4p5_f9n128r35p1
21. len4096_downsample8_bs_c1r4p5_f9n128r35p2
22. fake_shuffle_len4096_bs_c1r4p5_f9n128r35p2
23. len2048_resize3_bs_c8p8_f9n256_r35p1
24. resize3_c1r4p5_f9n128r35p1
25. fake_shuffle_c9p9_bs_f9n64_r35p2
26. fake_shuffle_len2048p4_resize3_c1r4p5_f9n128r35p1
27. len4096_resize3_bs_c1r4p5_f9n128r35p1
28. fake_shuffle_len2048p4_resize3_bs_c1r4p5_f9n128r35p1
29. resize3_bs_c1r4p5_f9n256r35p1
30. fake_shuffle_len3584_bs_c1r4p5_f9n192r35p2
31. len2048p1_resize3_bs_c1r4p5_f9n128r35p1
32. len4096_downsample8_leaky_bs_c1r4p5_f9n128r35p2
33. len4096_downsample4_leaky_bs_c1r4p5_f9n128r35p2
34. fake_shuffle_len4096_downsample4_resize3_bs_c1r4p5_f9n128r35p2
35. fake_shuffle_len4608_downsample4_bs_c1r4p5_f9n160r35p2
36. len4608_c9p9_f9n32_r35p1

#Parameters in model file
1. **data_path**: path of the training data which is generated by **read_data.py**
2. **train_series**: series list used for training. In the final re-train stage, this list should contain all the 8 series(start from 0 to 7)
3. **valid_series**: series list used for validation. In the final re-train stage, this list should be empty.
4. **test_series**: series list used for test. This parameter is temporariy not used.
5. **events**: events list used for training, validation and test. This parameter can be set with a portion of all the 6 events for event-specific model.
6. **num_events**: length of the **events** list
7. **xx_data_params**: parameters used to generated chunks. 
 1. **section**: specify in which section to used the generate function. Can be set with **train/valid/test**
 2. **chunk_gen_fun**: specify which chunk-generation function to use. Can be set with
  1. **random_chunk_gen_fun**: generate chunks randomly
  2. **fixed_chunk_gen_fun**: generate chunks with fixed order for every model
  3. **test_valid_chunk_gen_fun**: generate chunks for validation set with series-major sequencial order
  4. **sequence_chunk_gen_fun**: generate chunks for test set with sequencial order of the input data
 3. **channels**: channels of data (32 in this project)
 4. **length**: input length of the model
 5. **preprocess**: method to preprocess the input data. Selected from the following:
  1. **per_sample_mean**: subtract each channel of input data with the mean of the sample's corresponding channel 
  2. **per_sample_mean_variance**: subtract each channel of input data with the mean of the sample's corresponding channel, and divide by the correspoing sample channel's variance
  3. **mean**: substract input data with the mean of all training data
  4. **mean_variance**: substract input data with the mean of all training data, and divide it with variance of all training data
 6. **chunk_size**: number of samples in each chunk
 7. **num_chunks**: number of chunks for training (used only in **train_data_params**)
 8. **pos_ratio**: the ratio of positive samples generated by function in each chunk
 9. **bootstrap**: specify whether to do bootstrap or not
 10. **neg_pool_size**: size of the negative pool in bootstrap
 11. **hard_ratio**: hard negative samples' ratio in the negative pool
 12. **easy_mode**: method to generate non-hard negative samples. Selected from:
  1. **random**: randomly select from the data samples used in bootstap section
  2. **easy**: select the negative samples that are easy to classify for the model
  3. **all**: select the samples randomly from neative pool
 13. **resize**: range of resize ratio (used in training section only)
 14: **pos_interval**: time interval to generate positive samples (used only for **fixed_chunk_gen_fun**)
 15: **pos_interval**: time interval to generate negative samples (used only for **fixed_chunk_gen_fun**)
 16. **test_lens**: list of sample length for test or validation
 17. **interval**: time interval to generate samples (used only in **test_valid_params**)
 18. **test_valid**: specify whether to do validation or not
8. **batch_size**
9. **momentum**
10. **wc**: weight decay
11. **display_freq**: frequency to display the training results
12. **valid_freq**: frequency to test the validation set
13. **bs_freq**: frequency to do bootstrap (to stop bootstap, this parameter should set with a number larger than **tarin_data_params**'s **num_chunks**)
14. **save_freq**: frequency to save models

#Cross validation
The 8 series are evenly split into 4 groups, indexed by 01, 23, 45 and 67. Only **v67** validation models are uploaded. To change the validation set, you need to modify parameter **train_series** and **test_series** in model file. For example:    
xx_v01.py:    
```
  train_series = [2, 3, 4, 5, 6, 7]
  valid_series = [0, 1]
```
xx_v23.py:    
```
  train_series = [0, 1, 4, 5, 6, 7]
  valid_series = [2, 3]
```
xx_v45.py:    
```
  train_series = [0, 1, 2, 3, 6, 7]
  valid_series = [4, 5]
```
xx_v67.py:    
```
  train_series = [0, 1, 2, 3, 4, 5]
  valid_series = [6, 7]
```
In our experiments, we used fixed CV splits, in which 01, 23, 45 and 67 were used as validation set, respectively.
